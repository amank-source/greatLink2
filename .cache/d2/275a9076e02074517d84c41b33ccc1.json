{"id":"../data_layer/sync.js","dependencies":[{"name":"/Users/fakhan/great-link-2/package.json","includedInParent":true,"mtime":1609798652689},{"name":"./client","loc":{"line":1,"column":23},"parent":"/Users/fakhan/great-link-2/data_layer/sync.js","resolved":"/Users/fakhan/great-link-2/data_layer/client.js"}],"generated":{"js":"const client = require(\"./client\");\n\nconst sync = async (force = false) => {\n  if (force) {\n    await client.query(`\n      DROP TABLE IF EXISTS links;\n      DROP TABLE IF EXISTS tags;\n    `);\n  }\n\n  await client.query(`\n    CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\n\n    CREATE TABLE IF NOT EXISTS links(\n      id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n      link text NOT NULL UNIQUE CONSTRAINT link_length CHECK(LENGTH(link) > 0),\n      comment text,\n      clickCount integer NOT NULL DEFAULT 1 CONSTRAINT positive_count CHECK(clickCount > 0)\n    );\n\n    CREATE TABLE IF NOT EXISTS tags(\n      id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n      tag text NOT NULL UNIQUE CONSTRAINT tag_length CHECK(LENGTH(tag) > 0)\n    );\n\n    CREATE TABLE IF NOT EXISTS link_tags(\n      link_id uuid REFERENCES links(id),\n      tag_id uuid REFERENCES tags(id),\n      PRIMARY KEY(link_id, tag_id)\n    );\n  `);\n};\n\nmodule.exports = sync;"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":1,"column":0},"source":"../data_layer/sync.js","original":{"line":1,"column":0}},{"name":"client","generated":{"line":1,"column":6},"source":"../data_layer/sync.js","original":{"line":1,"column":6}},{"generated":{"line":1,"column":12},"source":"../data_layer/sync.js","original":{"line":1,"column":12}},{"name":"require","generated":{"line":1,"column":15},"source":"../data_layer/sync.js","original":{"line":1,"column":15}},{"generated":{"line":1,"column":22},"source":"../data_layer/sync.js","original":{"line":1,"column":22}},{"generated":{"line":1,"column":23},"source":"../data_layer/sync.js","original":{"line":1,"column":23}},{"generated":{"line":1,"column":33},"source":"../data_layer/sync.js","original":{"line":1,"column":22}},{"generated":{"line":1,"column":34},"source":"../data_layer/sync.js","original":{"line":1,"column":0}},{"generated":{"line":3,"column":0},"source":"../data_layer/sync.js","original":{"line":3,"column":0}},{"name":"sync","generated":{"line":3,"column":6},"source":"../data_layer/sync.js","original":{"line":3,"column":6}},{"generated":{"line":3,"column":10},"source":"../data_layer/sync.js","original":{"line":3,"column":10}},{"generated":{"line":3,"column":13},"source":"../data_layer/sync.js","original":{"line":3,"column":13}},{"name":"force","generated":{"line":3,"column":20},"source":"../data_layer/sync.js","original":{"line":3,"column":20}},{"generated":{"line":3,"column":25},"source":"../data_layer/sync.js","original":{"line":3,"column":25}},{"generated":{"line":3,"column":28},"source":"../data_layer/sync.js","original":{"line":3,"column":28}},{"generated":{"line":3,"column":33},"source":"../data_layer/sync.js","original":{"line":3,"column":13}},{"generated":{"line":3,"column":38},"source":"../data_layer/sync.js","original":{"line":3,"column":38}},{"generated":{"line":4,"column":0},"source":"../data_layer/sync.js","original":{"line":4,"column":2}},{"name":"force","generated":{"line":4,"column":6},"source":"../data_layer/sync.js","original":{"line":4,"column":6}},{"generated":{"line":4,"column":11},"source":"../data_layer/sync.js","original":{"line":4,"column":2}},{"generated":{"line":4,"column":13},"source":"../data_layer/sync.js","original":{"line":4,"column":13}},{"generated":{"line":5,"column":0},"source":"../data_layer/sync.js","original":{"line":5,"column":4}},{"name":"client","generated":{"line":5,"column":10},"source":"../data_layer/sync.js","original":{"line":5,"column":10}},{"generated":{"line":5,"column":16},"source":"../data_layer/sync.js","original":{"line":5,"column":16}},{"name":"query","generated":{"line":5,"column":17},"source":"../data_layer/sync.js","original":{"line":5,"column":17}},{"generated":{"line":5,"column":22},"source":"../data_layer/sync.js","original":{"line":5,"column":10}},{"generated":{"line":5,"column":23},"source":"../data_layer/sync.js","original":{"line":5,"column":24}},{"generated":{"line":8,"column":5},"source":"../data_layer/sync.js","original":{"line":5,"column":10}},{"generated":{"line":8,"column":6},"source":"../data_layer/sync.js","original":{"line":5,"column":4}},{"generated":{"line":9,"column":0},"source":"../data_layer/sync.js","original":{"line":9,"column":3}},{"generated":{"line":11,"column":0},"source":"../data_layer/sync.js","original":{"line":11,"column":2}},{"name":"client","generated":{"line":11,"column":8},"source":"../data_layer/sync.js","original":{"line":11,"column":8}},{"generated":{"line":11,"column":14},"source":"../data_layer/sync.js","original":{"line":11,"column":14}},{"name":"query","generated":{"line":11,"column":15},"source":"../data_layer/sync.js","original":{"line":11,"column":15}},{"generated":{"line":11,"column":20},"source":"../data_layer/sync.js","original":{"line":11,"column":8}},{"generated":{"line":11,"column":21},"source":"../data_layer/sync.js","original":{"line":11,"column":22}},{"generated":{"line":31,"column":3},"source":"../data_layer/sync.js","original":{"line":11,"column":8}},{"generated":{"line":31,"column":4},"source":"../data_layer/sync.js","original":{"line":11,"column":2}},{"generated":{"line":32,"column":0},"source":"../data_layer/sync.js","original":{"line":32,"column":1}},{"generated":{"line":32,"column":1},"source":"../data_layer/sync.js","original":{"line":3,"column":0}},{"name":"module","generated":{"line":34,"column":0},"source":"../data_layer/sync.js","original":{"line":34,"column":0}},{"generated":{"line":34,"column":6},"source":"../data_layer/sync.js","original":{"line":34,"column":6}},{"name":"exports","generated":{"line":34,"column":7},"source":"../data_layer/sync.js","original":{"line":34,"column":7}},{"generated":{"line":34,"column":14},"source":"../data_layer/sync.js","original":{"line":34,"column":0}},{"name":"sync","generated":{"line":34,"column":17},"source":"../data_layer/sync.js","original":{"line":34,"column":17}},{"generated":{"line":34,"column":21},"source":"../data_layer/sync.js","original":{"line":34,"column":0}}],"sources":{"../data_layer/sync.js":"const client = require(\"./client\");\n\nconst sync = async (force = false) => {\n  if (force) {\n    await client.query(`\n      DROP TABLE IF EXISTS links;\n      DROP TABLE IF EXISTS tags;\n    `);\n  }\n\n  await client.query(`\n    CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\n\n    CREATE TABLE IF NOT EXISTS links(\n      id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n      link text NOT NULL UNIQUE CONSTRAINT link_length CHECK(LENGTH(link) > 0),\n      comment text,\n      clickCount integer NOT NULL DEFAULT 1 CONSTRAINT positive_count CHECK(clickCount > 0)\n    );\n\n    CREATE TABLE IF NOT EXISTS tags(\n      id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n      tag text NOT NULL UNIQUE CONSTRAINT tag_length CHECK(LENGTH(tag) > 0)\n    );\n\n    CREATE TABLE IF NOT EXISTS link_tags(\n      link_id uuid REFERENCES links(id),\n      tag_id uuid REFERENCES tags(id),\n      PRIMARY KEY(link_id, tag_id)\n    );\n  `);\n};\n\nmodule.exports = sync;\n"},"lineCount":null}},"error":null,"hash":"5bb85f45cf54c9e99b0c60ac03a35a0a","cacheData":{"env":{}}}